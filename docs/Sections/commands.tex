% Table describing all of the commands
\begin{table}[H]
    \begin{center}
        \begin{tabular}{|c|c|}\hline
        Command & Description \\\hline
        \hyperref[sec:message:create]{create} & Creates a new spreadsheet \\\hline
        \hyperref[sec:message:delete]{delete} & Deletes a spreadsheet \\\hline
        \hyperref[sec:message:rename]{rename} & Renames a spreadsheet \\\hline
        \hyperref[sec:message:get_name]{get\_name} & Gets the name of a spreadsheet \\\hline
        \hyperref[sec:message:list]{list\_spreadsheets} & Lists all spreadsheets \\\hline
        \hyperref[sec:message:open]{open} & Subscribes the client to updates \\\hline
        \hyperref[sec:message:close]{close} & Unsubscribes the client to updates \\\hline
        \hyperref[sec:message:get_history]{get\_history} & Gets the edit history of a spreadsheet \\\hline
        \hyperref[sec:message:get_spreadsheet]{get\_spreadsheet} & Gets the contents of a spreadsheet \\\hline
        \hyperref[sec:message:push]{push} & Pushes edits to be applied to the spreadsheet \\\hline
        \hyperref[sec:message:undo]{undo} & Undoes the most recent edit of a spreadsheet \\\hline
        \end{tabular}
    \end{center}
\end{table}

\lstset{language=json,frame=single,numbers=none,captionpos=b}

\subsection{Common Data Types}

\subsubsection{Command}
\label{sec:message:command}

All \emph{Command}s contain the \emph{command} field which is used to identify the command being executed.
All \emph{Command}s will contain the following fields:

\begin{table}[H]
    \begin{center}
        \begin{tabular}{|c|c|c|}\hline
            Field & Type & Description \\\hline
            command & string & The command to execute \\\hline
            $\ldots$ & any & Command parameters \\\hline
        \end{tabular}
    \end{center}
\end{table}

\subsubsection{Result}
\label{sec:message:result}

There server will respond to each \emph{Command} with a \emph{Result}. \emph{Result}s have two 
variants: \emph{ok} and \emph{error}. All \emph{Result}s will contain the following fields:

\begin{table}[H]
    \begin{center}
        \begin{tabular}{|c|c|c|}\hline
            Field & Type & Description \\\hline
            result & string & Identifies the command this result is for \\\hline
            ok & boolean & Whether or not the command was successful \\\hline
        \end{tabular}
    \end{center}
\end{table}

If the \emph{Result} is ok ($ok = true$) then the \emph{Result} may contain addition fields
that contain the results of the command. Otherwise the \emph{Result} will contain the following fields:

\begin{table}[H]
    \begin{center}
        \begin{tabular}{|c|c|c|}\hline
            Field & Type & Description \\\hline
            error & string & A description of the error that occurred. \\\hline
        \end{tabular}
    \end{center}
\end{table}

\subsubsection{Edits and Spreadsheet}
\label{sec:message:edits}
\label{sec:message:spreadsheet}

Various commands will accept as parameters or return as a result the contents of a spreadsheet,
both \emph{Edit}s and \emph{Spreadsheet}s will contain spreadsheet contents. They differ in that
a \emph{Spreadsheet} object must contain the contents of a whole spreadsheet while a \emph{Edit}
object may contain a subset of the contents of a spreadsheet. Both \emph{Edit}s and \emph{Spreadsheet}s
will contain the following fields:

\begin{table}[H]
    \begin{center}
        \begin{tabular}{|c|c|c|}\hline
            Field & Type & Description \\\hline
            \$CellName & string & The contents of \$CellName. \\\hline
        \end{tabular}
    \end{center}
\end{table}

These data types are simply a mapping between cell names and their contents, valid cell names are a
capital letter from "A" to "Z" followed by a number from 1 to 99.

\subsection{Create}
\label{sec:message:create}
\input{Sections/commands/create}

\subsection{Delete}
\label{sec:message:delete}
\input{Sections/commands/delete}

\subsection{Rename}
\label{sec:message:rename}
\input{Sections/commands/rename}

\subsection{Get Name}
\label{sec:message:get_name}
\input{Sections/commands/get_name}

\subsection{List Spreadsheets}
\label{sec:message:list}
\input{Sections/commands/list}

\subsection{Open}
\label{sec:message:open}
\input{Sections/commands/open}

\subsection{Close}
\label{sec:message:close}
\input{Sections/commands/close}

\subsection{Get History}
\label{sec:message:get_history}
\input{Sections/commands/get_history}

\subsection{Get Spreadsheet}
\label{sec:message:get_spreadsheet}
\input{Sections/commands/get_spreadsheet}

\subsection{Undo}
\label{sec:message:undo}
\input{Sections/commands/undo}

\subsection{Push}
\label{sec:message:push}
\input{Sections/commands/push}
