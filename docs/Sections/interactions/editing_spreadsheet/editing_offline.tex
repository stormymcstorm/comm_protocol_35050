In order for the client to have a seamless editing experience while offline, the client will have to cache portions of the history of the spreadsheet, so that undo and reverts can still be supported. Undoes past the point where the client went offline will not be possible, and so will likely have to be replaced with revert operations. The client will also need to keep track of the edit id of the last edit it received from the server before going offline, it will be necessary for syncing with the server when the client comes back online.